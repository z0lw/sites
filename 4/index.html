<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheets API</title>
</head>
<body>

<p id="time-difference"></p>

<script>
  // Google Sheets APIの設定
  var spreadsheetId = 'YOUR_SPREADSHEET_ID';
  var range = 'latest!A1'; // シート名とセルの範囲
  var apiKey = 'AIzaSyCvkovQqfmxAGsz9H62GrCqOqlc7eKlTIw'; // サービス アカウントではなく、API キーを使用する場合

  // Google Sheets APIを呼び出す関数
  function getDataFromGoogleSheets() {
    gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId: spreadsheetId,
      range: range,
    }).then(function(response) {
      var spreadsheetDate = new Date(response.result.values[0][0]);
      var currentDate = new Date();

      var timeDifference = currentDate - spreadsheetDate;
      var timeDifferenceInSeconds = timeDifference / 1000;
      var seconds = Math.floor(timeDifferenceInSeconds % 60);
      var timeDifferenceInMinutes = timeDifferenceInSeconds / 60;
      var minutes = Math.floor(timeDifferenceInMinutes % 60);
      var hours = Math.floor(timeDifferenceInMinutes / 60);

      var result = "差：" + hours + "時間 " + minutes + "分 " + seconds + "秒";
      document.getElementById("time-difference").innerText = result;
    }, function(response) {
      console.error('Error: ' + response.result.error.message);
    });
  }

  // Google Sheets APIを初期化
  function initGoogleSheetsApi() {
    gapi.client.init({
      apiKey: apiKey,
      discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
    }).then(function() {
      getDataFromGoogleSheets();
    }, function(response) {
      console.error('Error: ' + response.result.error.message);
    });
  }

  // Google API ライブラリを読み込む
  function loadGoogleApi() {
    var script = document.createElement('script');
    script.src = 'https://apis.google.com/js/api.js';
    script.onload = function() {
      gapi.load('client', initGoogleSheetsApi);
    };
    document.head.appendChild(script);
  }

  // Google API ライブラリを読み込んで処理を開始
  loadGoogleApi();

</script>

</body>
</html>
